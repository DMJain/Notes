# Executors in Java

## Prerequisites
- [c1: Introduction to Concurrency](../c1_introduction_to_concurrency/ConcurrencyNotes.md) â€” Understanding processes, CPU scheduling
- [c2: Threads in Java](../c2_threads_in_java/ThreadsNotes.md) â€” Creating threads, Runnable, thread lifecycle

---

## What You'll Learn

| Question | Answer |
|----------|--------|
| **WHAT** | Executor Framework = a high-level API to manage thread creation and task execution |
| **WHY** | To avoid the pain of creating/destroying threads manually for every task |
| **WHEN** | Any time you need to run multiple tasks concurrently |
| **HOW** | Using `ExecutorService` and thread pools from `java.util.concurrent` |

---

## The Pain Point: Manual Thread Management

In c2, we learned to create threads like this:

```java
for (int i = 0; i < 100; i++) {
    Thread t = new Thread(new NumberPrinter(i));
    t.start();
}
```

### What's Wrong With This?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          THE PROBLEM: CREATING 100 THREADS MANUALLY              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   Task: Print numbers 0-99                                       â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”                â”‚
â”‚   â”‚ T-0 â”‚ â”‚ T-1 â”‚ â”‚ T-2 â”‚ â”‚ T-3 â”‚ . . . â”‚T-99 â”‚                â”‚
â”‚   â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜       â””â”€â”€â”¬â”€â”€â”˜                â”‚
â”‚      â”‚       â”‚       â”‚       â”‚              â”‚                    â”‚
â”‚      â–¼       â–¼       â–¼       â–¼              â–¼                    â”‚
â”‚   Create  Create  Create  Create  ...    Create                  â”‚
â”‚   ~1ms    ~1ms    ~1ms    ~1ms           ~1ms                    â”‚
â”‚   Stack   Stack   Stack   Stack          Stack                   â”‚
â”‚   ~1MB    ~1MB    ~1MB    ~1MB           ~1MB                    â”‚
â”‚                                                                  â”‚
â”‚   PROBLEMS:                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ âŒ 100 threads = 100MB stack memory (expensive!)          â”‚  â”‚
â”‚   â”‚ âŒ 100ms just creating threads (overhead!)                â”‚  â”‚
â”‚   â”‚ âŒ Context switching between 100 threads (CPU waste!)     â”‚  â”‚
â”‚   â”‚ âŒ Each thread created â†’ used once â†’ destroyed (wasteful!)â”‚  â”‚
â”‚   â”‚ âŒ What if 10,000 tasks? System might crash!              â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   ğŸ’¡ Question: Can't we REUSE threads instead of creating new?   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### The Real-World Problem

Imagine you're building a web server that handles HTTP requests:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             WEB SERVER: 1000 REQUESTS PER SECOND                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   âŒ NAIVE APPROACH: One thread per request                      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”‚
â”‚                                                                  â”‚
â”‚   Request 1 â”€â”€â–º new Thread() â”€â”€â–º Handle â”€â”€â–º destroy              â”‚
â”‚   Request 2 â”€â”€â–º new Thread() â”€â”€â–º Handle â”€â”€â–º destroy              â”‚
â”‚   Request 3 â”€â”€â–º new Thread() â”€â”€â–º Handle â”€â”€â–º destroy              â”‚
â”‚   ...                                                            â”‚
â”‚   Request 1000 â”€â”€â–º new Thread() â”€â”€â–º Handle â”€â”€â–º destroy           â”‚
â”‚                                                                  â”‚
â”‚   RESULT:                                                        â”‚
â”‚   â€¢ 1000 threads created per second                              â”‚
â”‚   â€¢ 1000 threads destroyed per second                            â”‚
â”‚   â€¢ Memory: 1000MB Ã— 1 second = 1GB RAM just for stacks!        â”‚
â”‚   â€¢ CPU: Constant context switching = server meltdown ğŸ”¥         â”‚
â”‚                                                                  â”‚
â”‚   âœ… SMART APPROACH: Thread Pool (reuse threads)                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    THREAD POOL (10 threads)              â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚   â”‚   â”‚ T-1 â”‚ â”‚ T-2 â”‚ â”‚ T-3 â”‚ ...  â”‚ T-10â”‚                  â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜      â””â”€â”€â”¬â”€â”€â”˜                  â”‚   â”‚
â”‚   â”‚      â”‚       â”‚       â”‚            â”‚                      â”‚   â”‚
â”‚   â”‚      â–¼       â–¼       â–¼            â–¼                      â”‚   â”‚
â”‚   â”‚   [Task1] [Task2] [Task3]  ...  [Task10]                 â”‚   â”‚
â”‚   â”‚      â”‚       â”‚       â”‚            â”‚                      â”‚   â”‚
â”‚   â”‚      â–¼       â–¼       â–¼            â–¼                      â”‚   â”‚
â”‚   â”‚   [Task11][Task12][Task13] ...  [Task20]  (REUSED!)      â”‚   â”‚
â”‚   â”‚      â”‚       â”‚       â”‚            â”‚                      â”‚   â”‚
â”‚   â”‚      â–¼       â–¼       â–¼            â–¼                      â”‚   â”‚
â”‚   â”‚   [Task21][Task22]  ...          ...      (REUSED!)      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   RESULT:                                                        â”‚
â”‚   â€¢ Only 10 threads exist (10MB stack memory)                    â”‚
â”‚   â€¢ Threads REUSED for 1000 tasks                                â”‚
â”‚   â€¢ No creation/destruction overhead                             â”‚
â”‚   â€¢ Server stays responsive âœ…                                    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## The Solution: Executor Framework

### The Kitchen Analogy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 THE KITCHEN ANALOGY                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   WITHOUT EXECUTOR (Manual Thread Management)                    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
â”‚                                                                  â”‚
â”‚   ğŸ‘¨â€ğŸ³ Head Chef says:                                             â”‚
â”‚   "For each order, hire a new cook, train them,                  â”‚
â”‚    they cook ONE dish, then fire them."                          â”‚
â”‚                                                                  â”‚
â”‚   Order 1 â”€â”€â–º Hire Cook â”€â”€â–º Cook Pasta â”€â”€â–º Fire Cook            â”‚
â”‚   Order 2 â”€â”€â–º Hire Cook â”€â”€â–º Cook Pizza â”€â”€â–º Fire Cook            â”‚
â”‚   Order 3 â”€â”€â–º Hire Cook â”€â”€â–º Cook Salad â”€â”€â–º Fire Cook            â”‚
â”‚                                                                  â”‚
â”‚   âŒ Absurd! Training and firing takes longer than cooking!      â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   WITH EXECUTOR (Thread Pool)                                    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚
â”‚                                                                  â”‚
â”‚   ğŸ‘¨â€ğŸ³ Head Chef says:                                             â”‚
â”‚   "I have 3 trained sous-chefs. They stay employed.             â”‚
â”‚    When orders come, assign them. When done, they wait."        â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                 KITCHEN (Thread Pool)                   â”‚    â”‚
â”‚   â”‚                                                         â”‚    â”‚
â”‚   â”‚   Order Queue: [ğŸ•] [ğŸ] [ğŸ¥—] [ğŸ°] [ğŸœ]                 â”‚    â”‚
â”‚   â”‚                  â†“    â†“    â†“                            â”‚    â”‚
â”‚   â”‚   Sous-Chef 1: ğŸ• â”€â”€â–º Done â”€â”€â–º ğŸ° â”€â”€â–º Done â”€â”€â–º ...     â”‚    â”‚
â”‚   â”‚   Sous-Chef 2: ğŸ â”€â”€â–º Done â”€â”€â–º ğŸœ â”€â”€â–º Done â”€â”€â–º ...     â”‚    â”‚
â”‚   â”‚   Sous-Chef 3: ğŸ¥— â”€â”€â–º Done â”€â”€â–º (waiting for order)     â”‚    â”‚
â”‚   â”‚                                                         â”‚    â”‚
â”‚   â”‚   âœ… Cooks REUSED for multiple orders                   â”‚    â”‚
â”‚   â”‚   âœ… No hiring/firing overhead                          â”‚    â”‚
â”‚   â”‚   âœ… Kitchen runs smoothly                              â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚   TRANSLATION:                                                   â”‚
â”‚   â€¢ Kitchen = Thread Pool                                        â”‚
â”‚   â€¢ Sous-chef = Worker Thread                                    â”‚
â”‚   â€¢ Order = Task (Runnable)                                      â”‚
â”‚   â€¢ Head Chef = ExecutorService                                  â”‚
â”‚   â€¢ Order Queue = Task Queue                                     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Using the Executor Framework

```java
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class ExecutorDemo {
    public static void main(String[] args) {
        // Create a pool with 10 reusable threads
        ExecutorService executor = Executors.newFixedThreadPool(10);
        
        // Submit 100 tasks (only 10 threads will handle them!)
        for (int i = 0; i < 100; i++) {
            executor.execute(new NumberPrinter(i));
        }
        
        // Shutdown when done
        executor.shutdown();
    }
}
```

### What Just Happened?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            EXECUTOR FRAMEWORK FLOW                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   STEP 1: Create Pool                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  ExecutorService executor = Executors.newFixedThreadPool(10);â”‚
â”‚   â”‚                                                           â”‚  â”‚
â”‚   â”‚  Creates 10 worker threads, waiting for tasks             â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   STEP 2: Submit Tasks                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  executor.execute(task1);  â”€â”€â–º Goes to task queue         â”‚  â”‚
â”‚   â”‚  executor.execute(task2);  â”€â”€â–º Goes to task queue         â”‚  â”‚
â”‚   â”‚  ...                                                      â”‚  â”‚
â”‚   â”‚  executor.execute(task100); â”€â”€â–º Goes to task queue        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   STEP 3: Workers Pick Up Tasks                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                                                           â”‚  â”‚
â”‚   â”‚   Task Queue: [T1][T2][T3][T4][T5]...[T100]              â”‚  â”‚
â”‚   â”‚                 â†“   â†“   â†“   â†“   ...  â†“                   â”‚  â”‚
â”‚   â”‚   Worker 1:   T1 â†’ T11 â†’ T21 â†’ T31 ...                   â”‚  â”‚
â”‚   â”‚   Worker 2:   T2 â†’ T12 â†’ T22 â†’ T32 ...                   â”‚  â”‚
â”‚   â”‚   Worker 3:   T3 â†’ T13 â†’ T23 â†’ T33 ...                   â”‚  â”‚
â”‚   â”‚   ...                                                     â”‚  â”‚
â”‚   â”‚   Worker 10:  T10 â†’ T20 â†’ T30 â†’ T40 ...                  â”‚  â”‚
â”‚   â”‚                                                           â”‚  â”‚
â”‚   â”‚   Each worker grabs next task when done (FIFO)            â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   STEP 4: Shutdown                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  executor.shutdown();                                     â”‚  â”‚
â”‚   â”‚                                                           â”‚  â”‚
â”‚   â”‚  â€¢ Stop accepting new tasks                               â”‚  â”‚
â”‚   â”‚  â€¢ Complete all queued tasks                              â”‚  â”‚
â”‚   â”‚  â€¢ Then terminate all threads                             â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Thread Pool: Deep Dive

### The Three Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              THREAD POOL ARCHITECTURE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   Your Code       â”‚         ExecutorService          â”‚           â”‚
â”‚       â”‚           â”‚     (Thread Pool Manager)        â”‚           â”‚
â”‚       â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚       â”‚                          â”‚                               â”‚
â”‚       â–¼                          â–¼                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                     TASK QUEUE (FIFO)                     â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”      â”‚  â”‚
â”‚   â”‚   â”‚Taskâ”‚â†’â”‚Taskâ”‚â†’â”‚Taskâ”‚â†’â”‚Taskâ”‚â†’â”‚Taskâ”‚â†’â”‚Taskâ”‚â†’â”‚Taskâ”‚      â”‚  â”‚
â”‚   â”‚   â”‚ 1  â”‚ â”‚ 2  â”‚ â”‚ 3  â”‚ â”‚ 4  â”‚ â”‚ 5  â”‚ â”‚ 6  â”‚ â”‚ 7  â”‚      â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚   â”‚      â†“                   â†“                    â†“          â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â”‚                   â”‚                    â”‚              â”‚
â”‚          â–¼                   â–¼                    â–¼              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚                   WORKER THREADS                            â”‚â”‚
â”‚   â”‚                                                             â”‚â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚â”‚
â”‚   â”‚   â”‚ Worker 1 â”‚    â”‚ Worker 2 â”‚    â”‚ Worker 3 â”‚            â”‚â”‚
â”‚   â”‚   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚            â”‚â”‚
â”‚   â”‚   â”‚ Running  â”‚    â”‚ Running  â”‚    â”‚  Idle    â”‚            â”‚â”‚
â”‚   â”‚   â”‚  Task 1  â”‚    â”‚  Task 2  â”‚    â”‚ (waiting)â”‚            â”‚â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚â”‚
â”‚   â”‚                                                             â”‚â”‚
â”‚   â”‚   â€¢ Pre-created (no startup cost per task)                  â”‚â”‚
â”‚   â”‚   â€¢ Reused for multiple tasks (no destroy/recreate)         â”‚â”‚
â”‚   â”‚   â€¢ Stay alive for lifetime of pool                         â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚                                                             â”‚â”‚
â”‚   â”‚   COMPONENT 1: Worker Threads                               â”‚â”‚
â”‚   â”‚   â€¢ Pool of pre-created threads                             â”‚â”‚
â”‚   â”‚   â€¢ Grab tasks from queue when idle                         â”‚â”‚
â”‚   â”‚                                                             â”‚â”‚
â”‚   â”‚   COMPONENT 2: Task Queue (BlockingQueue)                   â”‚â”‚
â”‚   â”‚   â€¢ Holds submitted tasks in FIFO order                     â”‚â”‚
â”‚   â”‚   â€¢ Threads pop from head of queue                          â”‚â”‚
â”‚   â”‚                                                             â”‚â”‚
â”‚   â”‚   COMPONENT 3: Pool Manager (ExecutorService)               â”‚â”‚
â”‚   â”‚   â€¢ Assigns tasks to threads                                â”‚â”‚
â”‚   â”‚   â€¢ Handles thread synchronization                          â”‚â”‚
â”‚   â”‚   â€¢ Manages lifecycle (create, shutdown)                    â”‚â”‚
â”‚   â”‚                                                             â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Why Thread Pools Save Resources

| Manual Thread Creation | Thread Pool |
|------------------------|-------------|
| Create thread for each task | Reuse existing threads |
| ~1ms per thread creation | 0ms (already exists) |
| ~1MB stack per thread | Fixed number of stacks |
| Destroy after use | Thread waits for next task |
| 1000 tasks = 1000 threads = 1GB | 1000 tasks = 10 threads = 10MB |

---

## Types of Thread Pools

Java provides 5 factory methods to create different types of pools:

### 1. FixedThreadPool

```java
ExecutorService executor = Executors.newFixedThreadPool(10);
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FIXED THREAD POOL                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   BEHAVIOR:                                                      â”‚
â”‚   â€¢ EXACTLY n threads, no more, no less                          â”‚
â”‚   â€¢ If all threads busy â†’ tasks wait in queue                    â”‚
â”‚   â€¢ If thread dies â†’ new one created to maintain count           â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                  Pool Size: 3 FIXED                      â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   Tasks: [T1][T2][T3][T4][T5][T6][T7][T8]               â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   Worker 1: T1 â”€â”€â–º T4 â”€â”€â–º T7                            â”‚   â”‚
â”‚   â”‚   Worker 2: T2 â”€â”€â–º T5 â”€â”€â–º T8                            â”‚   â”‚
â”‚   â”‚   Worker 3: T3 â”€â”€â–º T6 â”€â”€â–º (waiting...)                  â”‚   â”‚
â”‚   â”‚             â†“                                             â”‚   â”‚
â”‚   â”‚   (Only 3 tasks run at a time, rest queue)               â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   âœ… USE WHEN:                                                    â”‚
â”‚   â€¢ You know the optimal number of threads for your system       â”‚
â”‚   â€¢ Predictable load (known number of concurrent tasks)          â”‚
â”‚   â€¢ CPU-bound tasks (threads = number of CPU cores)              â”‚
â”‚                                                                  â”‚
â”‚   âŒ AVOID WHEN:                                                  â”‚
â”‚   â€¢ Unpredictable, bursty workload                               â”‚
â”‚   â€¢ Too many tasks â†’ queue grows infinitely â†’ OutOfMemory!       â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. CachedThreadPool

```java
ExecutorService executor = Executors.newCachedThreadPool();
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CACHED THREAD POOL                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   BEHAVIOR:                                                      â”‚
â”‚   â€¢ Creates new thread if none available                         â”‚
â”‚   â€¢ Reuses idle threads if available                             â”‚
â”‚   â€¢ Idle threads killed after 60 seconds                         â”‚
â”‚   â€¢ Pool size: 0 to INTEGER.MAX_VALUE (unbounded!)              â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚               Pool Size: DYNAMIC                         â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   TIME 0: 5 tasks arrive                                 â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚   â”‚   â”‚ W1  â”‚ â”‚ W2  â”‚ â”‚ W3  â”‚ â”‚ W4  â”‚ â”‚ W5  â”‚ (5 created)  â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   TIME 1: 3 tasks complete, 2 new tasks arrive           â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚   â”‚   â”‚ W1  â”‚ â”‚ W2  â”‚ â”‚ W3  â”‚ â”‚ W4  â”‚ â”‚ W5  â”‚ (reused!)    â”‚   â”‚
â”‚   â”‚   â”‚busy â”‚ â”‚busy â”‚ â”‚idle â”‚ â”‚newT â”‚ â”‚newT â”‚              â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   TIME 2: No tasks for 60 seconds                        â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                                       â”‚   â”‚
â”‚   â”‚   â”‚ W1  â”‚ â”‚ W2  â”‚  (W3, W4, W5 terminated)             â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜                                       â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   âœ… USE WHEN:                                                    â”‚
â”‚   â€¢ Many short-lived tasks                                       â”‚
â”‚   â€¢ Unpredictable task arrival                                   â”‚
â”‚   â€¢ I/O-bound tasks (lots of waiting)                            â”‚
â”‚                                                                  â”‚
â”‚   âŒ AVOID WHEN:                                                  â”‚
â”‚   â€¢ Long-running tasks (threads never get recycled)              â”‚
â”‚   â€¢ Could create too many threads and crash system!              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. SingleThreadExecutor

```java
ExecutorService executor = Executors.newSingleThreadExecutor();
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SINGLE THREAD EXECUTOR                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   BEHAVIOR:                                                      â”‚
â”‚   â€¢ Exactly ONE thread                                           â”‚
â”‚   â€¢ Tasks execute in ORDER (FIFO)                                â”‚
â”‚   â€¢ If thread dies, new one created                              â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                  Pool Size: 1                            â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   Tasks: [T1][T2][T3][T4][T5]                           â”‚   â”‚
â”‚   â”‚           â†“                                              â”‚   â”‚
â”‚   â”‚   Worker: T1 â”€â”€â–º T2 â”€â”€â–º T3 â”€â”€â–º T4 â”€â”€â–º T5                â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   ONE task at a time, in EXACT order submitted          â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   "Wait, isn't this just a regular thread?"                      â”‚
â”‚                                                                  â”‚
â”‚   NO! Benefits:                                                   â”‚
â”‚   â€¢ Tasks queued (won't be lost)                                 â”‚
â”‚   â€¢ Thread auto-recreates if it dies                             â”‚
â”‚   â€¢ Clean shutdown API                                           â”‚
â”‚   â€¢ No manual Thread management                                  â”‚
â”‚                                                                  â”‚
â”‚   âœ… USE WHEN:                                                    â”‚
â”‚   â€¢ Tasks MUST run in order (e.g., log writes)                   â”‚
â”‚   â€¢ Sequential database operations                               â”‚
â”‚   â€¢ Single-threaded event loops                                  â”‚
â”‚                                                                  â”‚
â”‚   âŒ AVOID WHEN:                                                  â”‚
â”‚   â€¢ Tasks don't need ordering                                    â”‚
â”‚   â€¢ Parallelism needed                                           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. ScheduledThreadPool

```java
ScheduledExecutorService executor = Executors.newScheduledThreadPool(5);

// Run after 5 second delay
executor.schedule(task, 5, TimeUnit.SECONDS);

// Run every 5 seconds (fixed rate)
executor.scheduleAtFixedRate(task, 0, 5, TimeUnit.SECONDS);

// Run with 5 second delay BETWEEN executions
executor.scheduleWithFixedDelay(task, 0, 5, TimeUnit.SECONDS);
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SCHEDULED THREAD POOL                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   BEHAVIOR:                                                      â”‚
â”‚   â€¢ Fixed number of threads (like FixedThreadPool)               â”‚
â”‚   â€¢ Can schedule tasks for future execution                      â”‚
â”‚   â€¢ Supports periodic/repeated execution                         â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   scheduleAtFixedRate(task, 0, 5, TimeUnit.SECONDS)      â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   TIME â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚   â”‚
â”‚   â”‚   0s        5s        10s       15s       20s            â”‚   â”‚
â”‚   â”‚   â”‚         â”‚         â”‚         â”‚         â”‚              â”‚   â”‚
â”‚   â”‚   â–¼         â–¼         â–¼         â–¼         â–¼              â”‚   â”‚
â”‚   â”‚   [Task]   [Task]   [Task]   [Task]   [Task]             â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   âœ… USE WHEN:                                                    â”‚
â”‚   â€¢ Periodic tasks (heartbeats, polling, cleanup)                â”‚
â”‚   â€¢ Delayed execution                                            â”‚
â”‚   â€¢ Cron-like scheduling                                         â”‚
â”‚                                                                  â”‚
â”‚   Example: Health check every 30 seconds                         â”‚
â”‚   executor.scheduleAtFixedRate(                                  â”‚
â”‚       () -> checkServerHealth(),                                 â”‚
â”‚       0,          // initial delay                               â”‚
â”‚       30,         // period                                      â”‚
â”‚       TimeUnit.SECONDS                                           â”‚
â”‚   );                                                             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. WorkStealingPool (Java 8+)

```java
ExecutorService executor = Executors.newWorkStealingPool();
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   WORK STEALING POOL                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   BEHAVIOR:                                                      â”‚
â”‚   â€¢ Uses all available CPU cores                                 â”‚
â”‚   â€¢ Each worker has its OWN task queue                           â”‚
â”‚   â€¢ Idle workers STEAL tasks from busy workers                   â”‚
â”‚   â€¢ Based on Fork/Join framework                                 â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚            4-Core System = 4 Workers                     â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   Worker 1:  [T1][T2][T3][T4][T5]  â† Many tasks         â”‚   â”‚
â”‚   â”‚   Worker 2:  [T6][T7]              â† Some tasks         â”‚   â”‚
â”‚   â”‚   Worker 3:  [T8]                  â† One task           â”‚   â”‚
â”‚   â”‚   Worker 4:  [ ]                   â† Empty!             â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚                     WORK STEALING:                       â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   Worker 4 is idle... steals T5 from Worker 1!          â”‚   â”‚
â”‚   â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
â”‚   â”‚   Worker 1:  [T1][T2][T3][T4]     â”‚                     â”‚   â”‚
â”‚   â”‚   Worker 4:  [T5] â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   Result: All CPUs stay busy, better load balancing      â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   âœ… USE WHEN:                                                    â”‚
â”‚   â€¢ CPU-intensive parallel processing                            â”‚
â”‚   â€¢ Tasks that spawn subtasks (divide-and-conquer)               â”‚
â”‚   â€¢ Want to use all CPU cores automatically                      â”‚
â”‚                                                                  â”‚
â”‚   Example: Parallel stream processing                            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Quick Comparison Table

| Pool Type | Threads | Queue | Best For |
|-----------|---------|-------|----------|
| **FixedThreadPool** | Fixed n | Unbounded | Known workload, CPU tasks |
| **CachedThreadPool** | 0 to âˆ | None (direct handoff) | Many short I/O tasks |
| **SingleThreadExecutor** | 1 | Unbounded | Sequential execution |
| **ScheduledThreadPool** | Fixed n | Delayed queue | Periodic/delayed tasks |
| **WorkStealingPool** | = CPU cores | Per-worker deques | Parallel computation |

---

## Choosing the Right Pool: Decision Flowchart

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Do tasks need to run in order?  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                   â”‚
                    â–¼                                   â–¼
                   YES                                 NO
                    â”‚                                   â”‚
                    â–¼                                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
        â”‚ SingleThreadExecutor  â”‚                      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
                                                       â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   Do tasks need scheduled timing?   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                 â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚                                    â”‚
                              â–¼                                    â–¼
                             YES                                  NO
                              â”‚                                    â”‚
                              â–¼                                    â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
                  â”‚ ScheduledThreadPool   â”‚                       â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
                                                                  â–¼
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚      Is workload predictable?       â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                         â”‚
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚                                    â”‚
                                      â–¼                                    â–¼
                           YES (Steady load)                   NO (Bursty/Variable)
                                      â”‚                                    â”‚
                                      â–¼                                    â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   FixedThreadPool     â”‚       â”‚   CachedThreadPool    â”‚
                          â”‚  (threads = cores)    â”‚       â”‚   (dynamic sizing)    â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Benefits of Executor Framework

### Summary Table

| Benefit | Explanation |
|---------|-------------|
| **Simplifies Task Execution** | Focus on WHAT to do, not HOW to manage threads |
| **Efficient Resource Utilization** | Thread reuse = no creation/destruction overhead |
| **Better Control** | Configure pool size, queue, rejection policies |
| **Enhanced Scalability** | Adjust pool size without code changes |
| **Task Scheduling** | Built-in support for delayed/periodic execution |

### The Big Picture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            MANUAL THREADS vs EXECUTOR FRAMEWORK                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   MANUAL (what we did in c2):                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   Thread t = new Thread(task);                            â”‚  â”‚
â”‚   â”‚   t.start();                                              â”‚  â”‚
â”‚   â”‚   // Repeat 100 times...                                  â”‚  â”‚
â”‚   â”‚                                                           â”‚  â”‚
â”‚   â”‚   Problems:                                               â”‚  â”‚
â”‚   â”‚   â€¢ YOU manage thread creation                            â”‚  â”‚
â”‚   â”‚   â€¢ YOU handle thread count limits                        â”‚  â”‚
â”‚   â”‚   â€¢ YOU worry about cleanup                               â”‚  â”‚
â”‚   â”‚   â€¢ YOU deal with exceptions                              â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   EXECUTOR (what we learned today):                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   ExecutorService executor = Executors.newFixedThreadPool(10);â”‚
â”‚   â”‚   executor.execute(task);                                 â”‚  â”‚
â”‚   â”‚   executor.shutdown();                                    â”‚  â”‚
â”‚   â”‚                                                           â”‚  â”‚
â”‚   â”‚   Benefits:                                               â”‚  â”‚
â”‚   â”‚   â€¢ FRAMEWORK manages thread creation âœ…                  â”‚  â”‚
â”‚   â”‚   â€¢ FRAMEWORK handles limits âœ…                           â”‚  â”‚
â”‚   â”‚   â€¢ FRAMEWORK does cleanup âœ…                             â”‚  â”‚
â”‚   â”‚   â€¢ FRAMEWORK centralizes exception handling âœ…           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   ğŸ’¡ Even for a SINGLE thread, use SingleThreadExecutor!         â”‚
â”‚      You get queuing, auto-recovery, and clean APIs for free.   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Common Gotchas

### 1. Forgetting to Shutdown

```java
// âŒ BAD: Program never terminates!
ExecutorService executor = Executors.newFixedThreadPool(10);
executor.execute(task);
// No shutdown() called â†’ threads keep running â†’ JVM never exits!

// âœ… GOOD: Always shutdown
ExecutorService executor = Executors.newFixedThreadPool(10);
try {
    executor.execute(task);
} finally {
    executor.shutdown();
}
```

### 2. submit() vs execute()

```java
// execute() â†’ void, for Runnable
executor.execute(() -> System.out.println("Hi"));

// submit() â†’ Future, for Runnable OR Callable
Future<?> future = executor.submit(() -> System.out.println("Hi"));

// âš ï¸ submit() swallows exceptions silently!
executor.submit(() -> {
    throw new RuntimeException("Oops!");
});
// No exception printed! Must call future.get() to see it.
```

### 3. Unbounded Queue = Memory Bomb

```java
// âŒ DANGER: FixedThreadPool has UNBOUNDED queue
ExecutorService executor = Executors.newFixedThreadPool(2);

// If tasks arrive faster than processed â†’ queue grows â†’ OutOfMemoryError!
for (int i = 0; i < 1_000_000; i++) {
    executor.execute(longRunningTask);  // Queue fills up!
}

// âœ… BETTER: Use ThreadPoolExecutor with bounded queue
ThreadPoolExecutor executor = new ThreadPoolExecutor(
    2,                             // core pool size
    4,                             // max pool size
    60, TimeUnit.SECONDS,          // idle timeout
    new ArrayBlockingQueue<>(100)  // BOUNDED queue!
);
```

---

## Summary

| Concept | Key Point |
|---------|-----------|
| **Thread Pool** | Reuse threads instead of create/destroy for each task |
| **ExecutorService** | High-level API for managing thread pools |
| **FixedThreadPool** | Fixed number of threads, unbounded queue |
| **CachedThreadPool** | Dynamic threads, suited for short tasks |
| **SingleThreadExecutor** | Sequential execution with queue |
| **ScheduledThreadPool** | Delayed and periodic task execution |
| **WorkStealingPool** | Uses all cores, workers steal from each other |
| **shutdown()** | Always call to properly terminate pool |

---

## Project Demo Structure

```
c3_executors/
â”œâ”€â”€ ExecutorsNotes.md         â† You are here
â”œâ”€â”€ Main.java                 â† Entry point with all demos
â””â”€â”€ examples/
    â”œâ”€â”€ NumberPrinterTask.java     â† Simple Runnable task
    â””â”€â”€ ThreadPoolTypesDemo.java   â† Demos all pool types
```

---

## Next Chapter
â†’ [c4: Callables & Futures](../c4_callables/CallablesNotes.md) â€” Getting return values from threads
